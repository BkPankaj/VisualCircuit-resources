{
  "version": "1.0",
  "package": {
    "name": "PID",
    "version": "1.0.0",
    "description": "Navigation using PID",
    "author": "Muhammad Taha Suhail",
    "image": "%3Csvg%20height=%22512%22%20viewBox=%220%200%2064%2064%22%20width=%22512%22%20xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cpath%20d=%22M25.42%2062H4v-8.29c0-2.95%201.2-5.63%203.14-7.57.84-.84%201.82-1.54%202.9-2.06a10.614%2010.614%200%200%201%205.96-1c2.82.34%205.34%201.78%207.05%203.92%201.18%201.46%201.98%203.23%202.26%205.2L26%2057l.03.08%204.81-2.19%201.98%204.46-4.38%202c-.95.43-1.98.65-3.02.65z%22%20fill=%22#fcd770%22/%3E%3Cpath%20d=%22M37.42%2056.99c.55-1.15.58-1.35.58-1.56%200-1.34-1.09-2.43-2.43-2.43h-.04c-.35%200-.69.07-1.01.22l-1.2.54A5.765%205.765%200%200%201%2038.24%2051H40c.73%200%201.41.2%202%20.54.3.17.58.39.83.63C43.55%2052.9%2044%2053.9%2044%2055s-.9%202-2%202h-4.57z%22%20fill=%22#b4dd7f%22/%3E%3Cpath%20d=%22M33.32%2053.76l-.01.01-1.31.59V47h10v4.54a3.99%203.99%200%200%200-2-.54h-1.76c-2.01%200-3.88%201.05-4.92%202.76z%22%20fill=%22#aab2bd%22/%3E%3Cpath%20d=%22M62%2039v4c0%202.21-1.79%204-4%204H23.05A10.662%2010.662%200%200%200%2016%2043.08V40h-.32c.85%200%201.66-.34%202.25-.93L18%2039z%22%20fill=%22#ccd1d9%22/%3E%3Cpath%20d=%22M58%2013H21.94c-.33%203.46-2.44%206.4-5.4%207.91.89.74%201.46%201.85%201.46%203.09h3a2%202%200%200%201%202%202c0%20.55-.22%201.05-.59%201.41-.36.37-.86.59-1.41.59h-3l.85%208.5c.01.1.01.21.01.31%200%20.81-.3%201.59-.86%202.19h44V17c0-2.21-1.79-4-4-4z%22%20fill=%22#69d6f4%22/%3E%3Ccircle%20cx=%2248%22%20cy=%2213%22%20fill=%22#e6e9ed%22%20r=%2210%22/%3E%3Cpath%20d=%22M27%2029h8v6h-8z%22%20fill=%22#fcd770%22/%3E%3Cpath%20d=%22M21.94%2013c-.33%203.46-2.44%206.4-5.4%207.91-.69-.57-1.58-.91-2.54-.91h-4c-1.04%200-2.02.26-2.87.73A9.995%209.995%200%200%201%202%2012C2%206.48%206.48%202%2012%202s10%204.48%2010%2010c0%20.34-.02.67-.06%201z%22%20fill=%22#e6e9ed%22/%3E%3Cpath%20d=%22M10%2035v5c-3.58-1.19-6-4.55-6-8.33V28h6l-.94.94a3.618%203.618%200%200%200%200%205.12z%22%20fill=%22#656d78%22/%3E%3Cpath%20d=%22M18%2024h-2.76c-.76%200-1.45.43-1.79%201.1L12%2028H4v-2c0-2.27%201.27-4.25%203.13-5.27.85-.47%201.83-.73%202.87-.73h4c.96%200%201.85.34%202.54.91.89.74%201.46%201.85%201.46%203.09z%22%20fill=%22#ff826e%22/%3E%3Cpath%20d=%22M21%2024a2%202%200%200%201%202%202c0%20.55-.22%201.05-.59%201.41-.36.37-.86.59-1.41.59h-9l1.45-2.9c.34-.67%201.03-1.1%201.79-1.1H18z%22%20fill=%22#fc6e51%22/%3E%3Cpath%20d=%22M35.57%2053c1.34%200%202.43%201.09%202.43%202.43%200%20.21-.03.41-.58%201.56-.22.28-.51.5-.85.66l-3.75%201.7-1.98-4.46%201.16-.53%201.31-.59.01-.01%201.2-.54c.32-.15.66-.22%201.01-.22zM10%2040v-5l-.94-.94a3.618%203.618%200%200%201%200-5.12L10%2028h8l.85%208.5c.01.1.01.21.01.31%200%20.81-.3%201.59-.86%202.19l-.07.07c-.59.59-1.4.93-2.25.93H16v3.08a10.614%2010.614%200%200%200-5.96%201L10%2044z%22%20fill=%22#f0d0b4%22/%3E%3Cg%3E%3Cpath%20d=%22M13%2010.162L14.279%2014H19v-2h-3.279L13%203.838l-3.186%209.556L8.618%2011H5v2h2.382l2.804%205.606z%22/%3E%3Cpath%20d=%22M58%2048c2.757%200%205-2.243%205-5V17a5.006%205.006%200%200%200-4.046-4.904C58.492%206.453%2053.76%202%2048%202c-5.728%200-10.442%204.402-10.949%2010H23c0-6.065-4.935-11-11-11S1%205.935%201%2012c0%203.468%201.642%206.707%204.364%208.77A6.977%206.977%200%200%200%203%2026V31.675a9.758%209.758%200%200%200%206%209.014v2.808c-3.575%202.007-6%205.831-6%2010.214V63h22.856v-.023a8.222%208.222%200%200%200%202.994-.72l8.136-3.698c.317-.144.603-.334.856-.559H42a2.996%202.996%200%200%200%202.816-2H60c1.654%200%203-1.346%203-3s-1.346-3-3-3h-6a1%201%200%200%201-1-1v-1zm0-2H23.488A11.783%2011.783%200%200%200%2017%2042.235v-1.47A4.178%204.178%200%200%200%2018.364%2040H61v3c0%201.654-1.346%203-3%203zm-18%204h-1.764c-2.049%200-3.998.95-5.236%202.476V48h8v2.101A4.995%204.995%200%200%200%2040%2050zm-13.186%205.623l-.51-3.568A11.585%2011.585%200%200%200%2024.921%2048H31v5.72zM13.618%2026.999l.724-1.447a.994.994%200%200%201%20.895-.553H21a1.001%201.001%200%200%201%200%202zM48%204c4.963%200%209%204.038%209%209s-4.037%209-9%209-9-4.038-9-9%204.037-9%209-9zM37.051%2014c.507%205.598%205.221%2010%2010.949%2010%205.672%200%2010.353-4.316%2010.937-9.835A2.993%202.993%200%200%201%2061%2017v21H19.676a4.146%204.146%200%200%200%20.168-1.602l-.74-7.399H21c1.654%200%203-1.346%203-3s-1.346-3-3-3h-2.101a4.965%204.965%200%200%200-.815-1.851A10.917%2010.917%200%200%200%2022.796%2014zM3%2012c0-4.962%204.037-9%209-9s9%204.038%209%209c0%203.207-1.689%206.106-4.422%207.726A4.953%204.953%200%200%200%2014.001%2019H10c-.997%200-1.944.213-2.803.59C4.604%2017.945%203%2015.09%203%2012zm2%2014c0-2.757%202.243-5%205-5h4.001c1.304%200%202.415.835%202.827%201.999h-1.592a2.984%202.984%200%200%200-2.684%201.658l-1.171%202.342H5zm0%205.675v-2.676h2.741A4.583%204.583%200%200%200%207%2031.5c0%201.216.493%202.407%201.354%203.268l.646.646v3.043a7.756%207.756%200%200%201-4-6.782zm4.768%201.679A2.64%202.64%200%200%201%209%2031.5c0-.7.272-1.358.768-1.854l.647-.647h6.68l.76%207.6a2.175%202.175%200%200%201-.629%201.762c-.406.406-.97.64-1.545.64H13v2h2v1.013c-.097-.003-.192-.014-.289-.014-1.298%200-2.543.221-3.711.613v-8.027zm18.254%2027.083a6.23%206.23%200%200%201-2.6.563%206.247%206.247%200%200%201-6.021-4.48l-1.442-4.807-1.916.574%201.442%204.807A8.244%208.244%200%200%200%2020.044%2061H5v-7.289C5%2048.356%209.356%2044%2014.711%2044c4.801%200%208.934%203.584%209.612%208.338l.593%204.147-1.33.605.828%201.82%205.921-2.692%201.171%202.634zm8.137-3.699l-2.831%201.287-1.171-2.635%202.778-1.263c.184-.083.388-.127.631-.127.79%200%201.434.644%201.434%201.434%200%20.56-.33%201.072-.841%201.304zM42%2056h-3.052c.032-.186.052-.374.052-.566a3.42%203.42%200%200%200-2.216-3.194c.466-.151.953-.24%201.452-.24H40c1.654%200%203%201.346%203%203a1%201%200%200%201-1%201zm12-4h6a1%201%200%200%201%200%202H44.899A4.988%204.988%200%200%200%2043%2051.026V48h8v1c0%201.654%201.346%203%203%203z%22/%3E%3Cpath%20d=%22M57%2042h2v2h-2zM53%2042h2v2h-2zM49%2042h2v2h-2zM42%208h2v2h-2zM46%208h8v2h-8zM42%2012h2v2h-2zM46%2012h8v2h-8zM42%2016h2v2h-2zM46%2016h8v2h-8zM36%2028H26v8h10zm-2%206h-6v-4h6zM26%2024h10v2H26zM26%2020h10v2H26zM26%2016h10v2H26zM38%2034h2v2h-2zM42%2034h17v2H42zM38%2030h21v2H38zM38%2026h21v2H38z%22/%3E%3C/g%3E%3C/svg%3E"
  },
  "design": {
    "board": "Python3-Noetic",
    "graph": {
      "blocks": [

        {
          "id": "Inp-0",
          "type": "basic.input",
          "data": {
            "name": "",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true
          },
          "position": {
            "x": 64,
            "y": 144
          }
        },

        {
          "id": "Inp-1",
          "type": "basic.input",
          "data": {
            "name": "E",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true
          },
          "position": {
            "x": 64,
            "y": 144
          }
        },


        {
          "id": "Out-0",
          "type": "basic.output",
          "data": {
            "name": "",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true
          },
          "position": {
            "x": 752,
            "y": 144
          }
        },
        
       {
          "id": "300",
          "type": "basic.code",
          "data": {
            "code": "import numpy as np\nimport math\nfrom time import sleep\nfrom utils.wires.wire_str import read_string, share_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    input_0 = read_string(input_wires[0])\n    output_0 = share_string(output_wires[0])\n\n    kp = float(parameters[1])\n    ki = float(parameters[2])\n    kd = float(parameters[3])\n    previousError, I = 0, 0\n\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[1])\n    except IndexError:\n        enabled = True\n\n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n\n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n\n    try:\n    \n        while True:\n        \n            if enabled or (update := bool(enable_wire.get()[0])):\n\n                msg = input_0.get()\n                \n                if msg[0] is not None:\n                \n                    error = float(msg[0])\n                    sleep(0.01)\n                    ticks += 1\n                    \n                    # PID Control Logic\n                    \n                    P = error\n                    I = I + error\n                    D = error-previousError\n                    PIDvalue = (kp*P) + (ki*I) + (kd*D)\n                    previousError = error\n            \n                    linear_velocity = 5.0\n            \n                    angular_velocity = -PIDvalue\n                    \n                    data = []\n                    data.extend((str(linear_velocity), str(angular_velocity)))\n                    to_write = np.array(data, dtype='<U6')\n                    output_0.add(to_write)\n                    control_data[0] += 1\n                    \n            sleep(control_data[1])\n\n    except KeyboardInterrupt:\n    \n        input_0.release()\n        output_0.release()\n        enable_wire.release()",
            "ports": {
              "in": [
                {
                  "name": "Inp-0"
                }
              ],
              "out": [
                {
                  "name": "Out-0"
                }
              ]
            }
          },
          "position": {
            "x": 50,
            "y": 100
          },
          "size": {
            "width": 800,
            "height": 600
          }
        },
        
        {
          "id": "400",
          "type": "basic.constant",
          "data": {
            "name": "Frequency", 
            "value": "30.0",
            "local": true
          },
          "position": {
            "x": 300,
            "y": 10
          }
        },     
        
        {
          "id": "401",
          "type": "basic.constant",
          "data": {
            "name": "Kp", 
            "value": "1.0",
            "local": true
          },
          "position": {
            "x": 400,
            "y": 10
          }
        },
        
        {
          "id": "402",
          "type": "basic.constant",
          "data": {
            "name": "Ki",
            "value": "1.0",
            "local": true
          },
          "position": {
            "x": 500,
            "y": 10
          }
        },
        
        {
          "id": "600",
          "type": "basic.constant",
          "data": {
            "name": "Kd",
            "value": "1.0",
            "local": true
          },
          "position": {
            "x": 600,
            "y": 10
          }
        } 
        
      ],

      "wires": [
        {
          "source": {
            "block": "",
            "port": ""
          },
          "target": {
            "block": "",
            "port": ""
          }
        },

        {
          "source": {
            "block": "",
            "port": ""
          },
          "target": {
            "block": "",
            "port": ""
          }
        }
      ]
    }
  },
  "dependencies": {}
}
